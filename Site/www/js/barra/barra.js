var BarraOngame={versao:"1.4.13",host:null,ambiente:null,usuario:null,jogo_aberto:!1,init:function(){this.carrega_host(),this.carrega_login(),this.m2_alterar_senha()},carrega_host:function(){var a=this;$.each($("script"),function(b,c){url=c.src,parametros=url.split("../erro4004.html"),""==parametros[1]&&(host=parametros[0].split("../index.html"),a.host=host[2],window.location.host.indexOf("localhost")>=0||window.location.host.indexOf("10.0.4")>=0?(a.protocolo="era-epica.html",a.host="localhost",a.minha_conta="localhost:8001",a.ambiente="ongame.net"):(url_dominio=window.location.host.split("ongame."),"teste"==url_dominio[1]&&(a.protocolo="era-epica.html"),"net"==url_dominio[1]&&(a.protocolo="era-epica.html"),a.minha_conta="minhaconta.ongame."+url_dominio[1],a.host="ongame."+url_dominio[1],a.ambiente="ongame."+url_dominio[1]),"ongame.undefined"==a.ambiente&&(a.ambiente="ongame.net"),"ongame.undefined"==a.host&&(a.host="ongame.net"))}),a.host&&this.insere_tag_barra()},insere_tag_barra:function(){return $("body").prepend("<div id='barra-ongame'></div>"),$("#barra-ongame").next().css({paddingTop:"32px"}),this.carrega_template()},carrega_template:function(){var a=this,b=a.versao+"_barra_cached";return a.barra_cached=localStorage.getItem(b),a.barra_cached?($("#barra-ongame").html(a.barra_cached),a.preenche_template(!1)):void $.ajax({url:a.protocolo+"//"+a.host+"/barra/barra.html"}).done(function(c){return $("#barra-ongame").html(c),localStorage.setItem(b,c),a.preenche_template(!1)})},preenche_template:function(a){var b=this;return a?void $.each(b.dados().logado,function(a,b){$("#barra-ongame .barra-ongame-centro .barra-ongame-botoes div ul").append("<li><a href='"+b.href+"'                     title='"+b.title+"' class='"+b.class+"' target='"+b.target+"'>                     <i class='fa "+b.fa+"'></i>"+b.title+"</a></li>")}):($("#barra-ongame .barra-ongame-logo a").attr("href",b.dados().logo_link),$("#barra-ongame .barra-ongame-logo a img").attr("src",b.dados().logo_img_src),$("#barra-ongame .barra-ongame-logo").attr("title",b.dados().logo_title),$("#barra-ongame .barra-ongame-logo a").attr("alt",b.dados().logo_title),$.each(b.dados().jogos,function(a,b){$("#barra-ongame .barra-ongame-centro .barra-ongame-jogos div ul").append("<li><a href='"+b.href+"'                     title='"+b.title+"' target='"+b.target+"'                     data-imagem='"+b.imagem+"'><i class='fa "+b.fa+"'></i>"+b.title+"</a></li>")}),$.each(b.dados().botoes,function(a,b){$("#barra-ongame .barra-ongame-centro .barra-ongame-botoes").prepend("<a href='"+b.href+"'                     title='"+b.title+"' target='"+b.target+"' class='"+b.class+"'>                     <i class='fa "+b.fa+"'></i>"+b.title+"</a>")}),this.submenu_hover())},submenu_hover:function(){var a=this;$("#barra-ongame .barra-ongame-jogos>a").bind({click:function(){a.jogo_aberto===!1?($(this).next().slideDown(),a.jogo_aberto=!0):($(this).next().slideUp(),a.jogo_aberto=!1)},blur:function(){var b=this;setTimeout(function(){$(b).next().slideUp(),a.jogo_aberto=!1},400),a.jogo_aberto=!1}});var b=$("#barra-ongame .barra-ongame-botoes div");return $("#barra-ongame .barra-ongame-botoes a.logado").bind({click:function(){a.logado_aberto?(b.slideUp(),a.logado_aberto=!1):(b.slideDown(),a.logado_aberto=!0)},blur:function(){setTimeout(function(){a.logado_aberto&&(b.slideUp(),a.logado_aberto=!1)},500)}}),$(".barra-ongame-jogos div ul li a").hover(function(){imagem=$(this).data("imagem"),$(".barra-ongame-jogos div img").attr("src",imagem)}),!0},carrega_login:function(){var a=this;return OGU=a.carrega_cookie("OGU"),OGN=a.carrega_cookie("OGN"),OGT=a.carrega_cookie("OGT"),OGS=a.carrega_cookie("OGS"),a.OGT=OGT,OGU&&(usuario=OGU,nickname=OGN,nickname&&(usuario=nickname),a.usuario=usuario,a.nickname=nickname,a.preenche_template(!0),$("#barra-ongame .login").hide(),$("#barra-ongame .cadastro").hide(),$("#barra-ongame .logado").show(),$("#barra-ongame .logado").append("Ol&aacute; "+usuario)),"True"==OGT?($("#barra-ongame").css({backgroundColor:"rgba(150, 0, 0, 0.7)"}),$("#barra-ongame .senha").show()):"True"==OGS&&($("#barra-ongame").css({backgroundColor:"rgba(150, 0, 0, 0.7)"}),$("#barra-ongame .trancado").show()),!0},dados:function(){var a=this,b=null,c=null;switch(b=window.location.host.split("."),b[0]){case"pb":c="?jogo=point-blank";break;case"aika":c="?jogo=aika";break;case"m2":c="?jogo=metin-2";break;case"itemmall":case"mercado":c="pb"===b[1]?"?jogo=point-blank":"aika"===b[1]?"?jogo=aika":"m2"===b[1]?"?jogo=metin-2":"?jogo=ongame";break;default:c="?jogo=ongame"}return itens={},itens.logo_link="//"+a.ambiente+"/",itens.logo_title="Ongame",itens.logo_img_src="http://ongame.net/barra/svg/logo-branco.svg",itens.jogos=[{href:"//pb."+a.ambiente+"/",title:"Point Blank",imagem:"//imagem.ongame.net/portal/barra/point-blank.jpg",target:"_blank"},{href:"//m2."+a.ambiente+"/",title:"Metin 2",imagem:"//imagem.ongame.net/portal/barra/metin-2.jpg",target:"_blank"},{href:"//aika."+a.ambiente+"/",title:"Aika",imagem:"//imagem.ongame.net/portal/barra/aika.jpg",target:"_blank"}],itens.botoes=[{href:"#",title:"",fa:"fa-gamepad",class:"logado",target:""},{href:"//"+a.minha_conta+"/cadastro/"+c+"&url="+window.location.href,title:"Cadastrar",fa:"fa-plus",class:"cadastro",target:"_blank"},{href:"//"+a.minha_conta+"/entrar/"+c+"&url="+window.location.href,title:"Entrar",fa:"fa-arrow-right",class:"login",target:""}],itens.logado=[{href:"//"+a.minha_conta+"/logout/"+c+"&url="+window.location.href,title:"Sair",fa:"fa-arrow-left",class:"",target:""},{href:"//"+a.minha_conta+"/alterar-senha/"+c+"&url="+window.location.href,title:"Alterar Senha",fa:"fa-key",class:"",target:"_blank"}],"localhost:8001"!==b[0]&&"m2"!==b[0]&&"m2"!==b[1]||itens.logado.push({href:"#",title:"Senha Personagem",fa:"fa-key",class:"m2_alterar_senha_personagem",target:"_self"},{href:"#",title:"Senha Armaz&eacute;m",fa:"fa-key",class:"m2_alterar_senha_armazem",target:"_self"}),itens.logado.push({href:"//"+a.minha_conta+"/alterar-email/"+c+"&url="+window.location.href,title:"Alterar E-mail",fa:"fa-envelope-o",class:"",target:"_blank"},{href:"//"+a.minha_conta+"/historico-de-punicao/"+c,title:"Hist&oacute;rico de Puni&ccedil;&atilde;o",fa:"fa-ban",class:"",target:"_blank"},{href:"//"+a.minha_conta+"/sessoes-ativas/"+c,title:"Sess&otilde;es Ativas",fa:"fa-map-marker",class:"",target:"_blank"}),"True"==a.OGT?itens.logado.push({href:"//"+a.minha_conta+"/destrancar-conta/"+c,title:"Destrancar conta",fa:"fa-unlock",class:"",target:"_blank"}):itens.logado.push({href:"//"+a.minha_conta+"/trancar-conta/"+c,title:"Trancar conta",fa:"fa-lock",class:"",target:"_blank"}),itens},carrega_cookie:function(a){var b=null;if(document.cookie&&""!=document.cookie)for(var c=document.cookie.split(";"),d=0;d<c.length;d++){var e=jQuery.trim(c[d]);if(e.substring(0,a.length+1)==a+"="){b=decodeURIComponent(e.substring(a.length+1));break}}return b},m2_alterar_senha:function(){var a=this,b="";$(".m2_alterar_senha_personagem").bind({click:function(){$.ajax({type:"POST",url:"//m2."+a.ambiente+"/login/senha-personagem",success:function(a){alert(a)}})}}),$(".m2_alterar_senha_armazem").bind({click:function(){a.logado_aberto=!1,0==$("#retorno_servidores").length&&(b='    <div style="background-color: #b35800;color: #101010;"><i class="fa fa-server" aria-hidden="true" style="color: #101010;margin-left: 4px;"></i> Escolha o servidor:</div>',$.ajax({type:"GET",dataType:"JSON",url:"//m2."+a.ambiente+"/login/senha-armazem/",success:function(c){$.each(c,function(a,c){b+='<li style="background-color: #D46800;"><a href="#" class="m2_servidor" data-servidor="'+a+'" title="'+c+'" style="color: #000;"><i class="fa fa-caret-right" aria-hidden="true"></i> '+c+"</a></li>"}),$(".m2_alterar_senha_armazem").after('<ul id="retorno_servidores" style="display:none;padding: 0px 4px 3px;">'+b+"</ul>"),a.m2_envia_id_servidor_armazem(),$("#retorno_servidores").slideDown(1e3),setTimeout(function(){a.logado_aberto=!0},1e3)}}))}})},m2_envia_id_servidor_armazem:function(){var a=this,b=0;$(".m2_servidor").bind({click:function(){servidor=parseInt($(this).data("servidor")),isNaN(b)||$.ajax({type:"POST",url:"//m2."+a.ambiente+"/login/senha-armazem/",data:{id_servidor:servidor},success:function(a){alert(a)}})}})}};$(document).ready(function(a){BarraOngame.init()});